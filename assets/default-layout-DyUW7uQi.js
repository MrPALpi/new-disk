import{d as y,p as J,s as f,q as W,o as d,i as w,w as p,a as i,e as m,k as M,_ as I,r as U,c as x,v as T,x as K,j as G,y as Q,F as X,z as A,A as j,t as F,u as o,l as R,B as Z,C as P,b as z}from"./index-dCgz1KnC.js";import{S as O}from"./svg-icon-Cw4ZkUu3.js";import{a as H,V as Y,b as D,d as ee}from"./v-form-Ir6wdYpx.js";const oe="eye",te="eye-close",se=y({__name:"v-password",props:{model:{},modelModifiers:{}},emits:["update:model"],setup(u){const s=J(u,"model"),t=f(!1),l=W(()=>t.value?"text":"password");return(e,a)=>(d(),w(H,{modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=c=>s.value=c),type:l.value,placeholder:"Введите пароль"},{right:p(()=>[i("span",{onClick:a[0]||(a[0]=c=>t.value=!t.value)},[m(M,{name:"icon",mode:"out-in"},{default:p(()=>[t.value?(d(),w(O,{key:0,name:te,class:"input-label__icon"})):(d(),w(O,{key:1,name:oe,class:"input-label__icon"}))]),_:1})])]),default:p(()=>[a[2]||(a[2]=i("input",{type:"password"},null,-1))]),_:1},8,["modelValue","type"]))}}),N=I(se,[["__scopeId","data-v-95e6cd55"]]),ae=y({__name:"v-popover",props:{closeClickContent:{type:Boolean}},setup(u){const s=u,t=U(!1),l=U(null),e=U(null),a=W(()=>{if(!l.value||!e.value)return{};const{top:r,left:C,width:g}=l.value.getBoundingClientRect();return{top:`${r+window.scrollY+70}px`,left:`${C+window.scrollX+g-e.value.clientWidth+20}px`,"--arrow-place":`${e.value.offsetWidth/2}px`}}),c=()=>{t.value=!t.value},n=r=>{const C=Object.is(r.relatedTarget,l.value),g=!r.relatedTarget;(s.closeClickContent||g||C)&&(t.value=!1)};return(r,C)=>(d(),x(X,null,[i("div",{ref_key:"trigger",ref:l,onClick:c,onBlur:n,class:"popover-trigger",tabindex:"-1"},[T(r.$slots,"trigger",{},void 0,!0)],544),(d(),w(Q,{to:"body"},[m(M,{name:"popover"},{default:p(()=>[t.value?(d(),x("div",{key:0,ref_key:"popover",ref:e,style:K(a.value),onBlur:n,class:"popover",tabindex:"-1"},[T(r.$slots,"content",{},void 0,!0)],36)):G("",!0)]),_:3})]))],64))}}),le=I(ae,[["__scopeId","data-v-1dc8d591"]]),ne={class:"user-info"},re={class:"user-info__name text-small"},ue=y({__name:"user-info",setup(u){const s=A(),t=j(),l=()=>{s.logout().then(()=>{console.log("tets"),t.push({name:"home"})})};return(e,a)=>(d(),w(o(le),{closeClickContent:!0},{trigger:p(()=>[i("div",ne,[i("span",re,F(o(s).email),1),m(o(O),{name:"user",class:"user-info__icon"})])]),content:p(()=>[i("a",{class:"exit",href:"#",onClick:R(l,["prevent"])},"Выйти")]),_:1}))}}),ie=I(ue,[["__scopeId","data-v-d099dd65"]]),de={class:"nav-bar container"},me={class:"nav-bar__right"},ce=y({__name:"nav-bar",setup(u){return(s,t)=>{const l=Z("router-link");return d(),x("div",de,[m(l,{to:"/",class:"nav-bar__home-link"},{default:p(()=>[m(o(O),{name:"logo",class:"nav-bar__logo"})]),_:1}),i("div",me,[T(s.$slots,"right",{},void 0,!0)])])}}}),ve=I(ce,[["__scopeId","data-v-9d512dcb"]]),pe="Поле не может быть пустым",_e="Некорректная почта",fe=/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/iu,L=()=>{const u=f(""),s=f("");return{email:u,validateEmail:()=>{if(!u.value.length)return s.value=pe,!1;const e=fe.test(u.value);return s.value=e?"":_e,e},errorEmail:s}},q=(u=0,s=1/0)=>{const t=`Поле не может быть больше ${s} символов`,l=`Поле не может быть меньше ${u} символов`,e="Поле не может быть пустым",a=f(""),c=f("");return{password:a,validatePassword:()=>{const r=a.value.length;return r===0?(c.value=e,!1):r<u?(c.value=l,!1):r>s?(c.value=t,!1):(c.value="",!0)},errorPassword:c}},ge="Поле не может быть пустым",we="Пароли не совпадают",Ee=u=>{const s=f(""),t=f("");return{confirmPassword:s,validateConfirmPassword:()=>{const e=s.value.length,a=!!e&&u.value===s.value;return t.value=a?"":e?we:ge,a},errorConfirmPassword:t}},Ce={class:"form__inputs"},ye={class:"form__bottom"},Ve={class:"form__bottom-text text-small"},be={key:0,class:"form__error text-small"},$e=y({__name:"login-form",emits:["to-sign-up","next-page"],setup(u,{emit:s}){const t=A(),l=s,{email:e,validateEmail:a,errorEmail:c}=L(),{password:n,validatePassword:r,errorPassword:C}=q(4,12),g=f(!1),V=f(""),B=()=>a()&&r(),S=(E="")=>{V.value=E,setTimeout(()=>{V.value=""},5e3)},$=async()=>{if(B()){g.value=!0;try{const E=await t.login(e.value,n.value);if(E.status)return l("next-page");S(E.message)}catch(E){console.error(E)}finally{g.value=!1}}};return(E,_)=>(d(),w(o(D),{onSubmit:R($,["prevent"]),loading:g.value,class:"login-form form"},{default:p(()=>[_[4]||(_[4]=i("h2",{class:"title-h2"},"Вход в ваш аккаунт",-1)),i("div",Ce,[m(o(H),{modelValue:o(e),"onUpdate:modelValue":_[0]||(_[0]=h=>P(e)?e.value=h:null),onChange:o(a),error:o(c),name:"email",label:"Email",placeholder:"Введите email",type:"email"},null,8,["modelValue","onChange","error"]),m(o(N),{modelValue:o(n),"onUpdate:modelValue":_[1]||(_[1]=h=>P(n)?n.value=h:null),onChange:o(r),error:o(C),name:"password",label:"Пароль",placeholder:"Введите пароль"},null,8,["modelValue","onChange","error"])]),i("div",ye,[i("span",Ve,[_[3]||(_[3]=z("У вас нет аккаунта? ")),i("a",{href:"#",onClick:_[2]||(_[2]=R(h=>l("to-sign-up"),["prevent"]))},"Зарегистрируйтесь")]),m(o(Y),{label:"Войти",type:"submit",class:"form__submit"}),m(M,{name:"form-error"},{default:p(()=>[V.value?(d(),x("div",be,F(V.value),1)):G("",!0)]),_:1})])]),_:1},8,["loading"]))}}),he={class:"form__inputs"},ke={class:"form__bottom"},xe={class:"form__bottom-text text-small"},Se={key:0,class:"form__error text-small"},Pe=y({__name:"sign-up-form",emits:["to-login","next-page"],setup(u,{emit:s}){const t=A(),l=s,{email:e,validateEmail:a,errorEmail:c}=L(),{password:n,validatePassword:r,errorPassword:C}=q(4,12),{confirmPassword:g,validateConfirmPassword:V,errorConfirmPassword:B}=Ee(n),S=f(!1),$=f(""),E=()=>a()&&r()&&V(),_=(b="")=>{$.value=b,setTimeout(()=>{$.value=""},5e3)},h=async()=>{if(E()){S.value=!0;try{const b=await t.signUp(e.value,n.value,g.value);if(b.status){const v=await t.login(e.value,n.value);if(v.status)return l("next-page");_(v.message)}_(b.message)}catch(b){console.error(b)}finally{S.value=!1}}};return(b,v)=>(d(),w(o(D),{onSubmit:R(h,["prevent"]),loading:S.value,class:"login-form form"},{default:p(()=>[v[5]||(v[5]=i("h2",{class:"title-h2"},"Регистрация",-1)),i("div",he,[m(o(H),{modelValue:o(e),"onUpdate:modelValue":v[0]||(v[0]=k=>P(e)?e.value=k:null),onChange:o(a),error:o(c),name:"email",label:"Email",placeholder:"Введите email",type:"email"},null,8,["modelValue","onChange","error"]),m(o(N),{modelValue:o(n),"onUpdate:modelValue":v[1]||(v[1]=k=>P(n)?n.value=k:null),onChange:o(r),error:o(C),name:"password",label:"Пароль",placeholder:"Введите пароль"},null,8,["modelValue","onChange","error"]),m(o(N),{modelValue:o(g),"onUpdate:modelValue":v[2]||(v[2]=k=>P(g)?g.value=k:null),onChange:o(V),error:o(B),name:"confirm_password",label:"Пароль ещё раз",placeholder:"Введите пароль ещё раз"},null,8,["modelValue","onChange","error"])]),i("div",ke,[i("span",xe,[v[4]||(v[4]=z("У вас есть аккаунт? ")),i("a",{href:"#",onClick:v[3]||(v[3]=R(k=>l("to-login"),["prevent"]))},"Войдите")]),m(o(Y),{label:"Зарегестрироваться",type:"submit",class:"form__submit"}),m(M,{name:"form-error"},{default:p(()=>[$.value?(d(),x("div",Se,F($.value),1)):G("",!0)]),_:1})])]),_:1},8,["loading"]))}}),Re=y({__name:"entry-form",emits:["close"],setup(u,{emit:s}){const t=s,l=j(),e=f(!0),a=()=>{t("close"),l.push({name:"note"})};return(c,n)=>(d(),w(M,{name:"form",mode:"out-in"},{default:p(()=>[e.value?(d(),w(o($e),{key:0,onToSignUp:n[0]||(n[0]=r=>e.value=!1),onNextPage:a})):(d(),w(o(Pe),{key:1,onToLogin:n[1]||(n[1]=r=>e.value=!0),onNextPage:a}))]),_:1}))}}),Me=I(Re,[["__scopeId","data-v-08c2353f"]]),Ie={class:"container"},Be=y({__name:"default-layout",setup(u){const s=A(),t=f(!1);return(l,e)=>(d(),x(X,null,[m(o(ve),null,{right:p(()=>[o(s).isAuth?(d(),w(o(ie),{key:0})):(d(),w(o(Y),{key:1,label:"Войти",icon:"login",onClick:e[0]||(e[0]=a=>t.value=!0)}))]),_:1}),i("main",Ie,[T(l.$slots,"default")]),m(o(ee),{modelValue:t.value,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value=a)},{default:p(()=>[m(o(Me),{onClose:e[1]||(e[1]=a=>t.value=!1)})]),_:1},8,["modelValue"])],64))}});export{Be as default};
