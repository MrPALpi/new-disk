import{f as w,g as B,r as I,s as v,d as h,o as _,c as p,a as m,t as S,e as d,u as l,_ as N,w as g,F as M,h as W,T as C,i as x,m as L,j as T,k as A,l as F,n as U}from"./index-BW6Pwd1S.js";import{V as $,a as k,b as D,c as E,d as P}from"./v-form-Bg95FnS6.js";import"./v-icon-gCxBPUp0.js";const V={async fetch(){const o=await w.get("/api/notes");return o==null?void 0:o.data},async add(o){const e=await w.post("/api/notes",o);return e==null?void 0:e.data},async delete(o){const e=await w.delete(`/api/notes/${o}`);return e==null?void 0:e.data}},b=B("note",()=>{const o=I([]),e=v(!1);return{notes:o,fetch:async()=>{var a;e.value=!0;try{const s=await V.fetch();if(Array.isArray(s))return o.value=s,{status:!0};throw s}catch(s){const{statusCode:n,message:r}=s;return{status:!1,message:(a=n==null?void 0:n.toString())!=null&&a.startsWith("4")?r:"Something went wrong"}}finally{e.value=!1}},add:async a=>{var s;e.value=!0;try{const n=await V.add(a);if("title"in n&&"content"in n)return o.value.push(n),{status:!0};throw n}catch(n){const{statusCode:r,message:i}=n;return{status:!1,message:(s=r==null?void 0:r.toString())!=null&&s.startsWith("4")?i:"Something went wrong"}}finally{e.value=!1}},deleteNote:async a=>{var s;e.value=!0;try{return await V.delete(a),o.value=o.value.filter(n=>n.id!==a),{status:!0}}catch(n){const{statusCode:r,message:i}=n;return{status:!1,message:(s=r==null?void 0:r.toString())!=null&&s.startsWith("4")?i:"Something went wrong"}}finally{e.value=!1}},loading:e}}),j={class:"note"},z={class:"note__header"},G={class:"note__title title-h4"},R={class:"note__content"},q={class:"note__footer"},H=h({__name:"note-item",props:{id:{},title:{},content:{}},emits:["delete"],setup(o,{emit:e}){const c=e;return(u,t)=>(_(),p("div",j,[m("div",z,[m("h3",G,S(u.title),1)]),m("div",R,S(u.content),1),m("div",q,[d(l($),{onClick:t[0]||(t[0]=a=>c("delete",u.id)),label:"Удалить",icon:"close",class:"note__delete"})])]))}}),J=N(H,[["__scopeId","data-v-6e1fe1bd"]]),K={key:0,class:"note-list"},O={key:1,class:"note-list-empty title-h1"},Q=h({__name:"note-list",setup(o){const e=b(),c=async t=>e.deleteNote(t),u=t=>{t.style.width=t.offsetWidth+"px"};return(t,a)=>l(e).notes.length?(_(),p("div",K,[d(C,{name:"note-list",onBeforeLeave:u},{default:g(()=>[(_(!0),p(M,null,W(l(e).notes,s=>(_(),x(l(J),L({key:s.id,ref_for:!0},s,{onDelete:c}),null,16))),128))]),_:1})])):(_(),p("div",O,"Заметок нет"))}}),X=N(Q,[["__scopeId","data-v-a2c1afbf"]]),Y={class:"form__inputs"},Z={class:"form__bottom"},ee={key:0,class:"form__error text-small"},te=h({__name:"note-add",emits:["close"],setup(o,{emit:e}){const c=e,u=b(),t=v(""),a=v(""),s=v(""),n=(i="")=>{t.value=i,setTimeout(()=>{t.value=""},5e3)},r=async()=>{try{const i=await u.add({title:a.value,content:s.value});if(a.value="",s.value="",i.status)return c("close");n(i.message)}catch(i){console.error(i)}};return(i,f)=>(_(),x(l(D),{onSubmit:F(r,["prevent"]),class:"add-note form",loading:l(u).loading},{default:g(()=>[f[2]||(f[2]=m("h2",{class:"title-h2"},"Добавление заметки",-1)),m("div",Y,[d(l(k),{modelValue:a.value,"onUpdate:modelValue":f[0]||(f[0]=y=>a.value=y),limit:100,name:"title",label:"Название заметки",placeholder:"Введите название"},null,8,["modelValue"]),d(l(k),{modelValue:s.value,"onUpdate:modelValue":f[1]||(f[1]=y=>s.value=y),limit:500,name:"title",label:"Текст заметки",placeholder:"Введите текст"},null,8,["modelValue"])]),m("div",Z,[d(l($),{label:"Добавить",type:"submit",class:"form__submit"}),d(A,{name:"form-error"},{default:g(()=>[t.value?(_(),p("div",ee,S(t.value),1)):T("",!0)]),_:1})])]),_:1},8,["loading"]))}}),se=h({__name:"note-page",setup(o){const e=v(!1),c=b();return c.fetch(),(u,t)=>(_(),p("div",{class:U([{"note-page_loading":l(c).loading},"note-page"])},[d(l(X)),d(l(E),{loading:l(c).loading},null,8,["loading"]),d(l($),{icon:"plus",onClick:t[0]||(t[0]=a=>e.value=!0),rounded:"",class:"note-page__add"}),d(l(P),{modelValue:e.value,"onUpdate:modelValue":t[2]||(t[2]=a=>e.value=a)},{default:g(()=>[d(l(te),{onClose:t[1]||(t[1]=a=>e.value=!1)})]),_:1},8,["modelValue"])],2))}}),le=N(se,[["__scopeId","data-v-45829ed2"]]);export{le as default};
